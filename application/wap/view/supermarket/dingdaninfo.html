<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
		<!--<title>牧场超市</title>-->
		<title>趣味农场</title>

		<link rel="stylesheet" type="text/css" href="__WAP__/font-awesome-4.7.0/css/font-awesome.min.css" />

		<link rel="stylesheet" type="text/css" href="__WAP__/css/header.css" />
		<link rel="stylesheet" type="text/css" href="__WAP__/css/spirit.css" />
		<link rel="stylesheet" type="text/css" href="__WAP__/css/media_quer.css" />
		<link rel="stylesheet" type="text/css" href="__WAP__/css/media_quer-background.css" />
		<script src="__WAP__/js/jquery.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			/*@fa-font-path: "font-awesome-4.7.0/less/variables.less";*/
			/*main*/

			body {
				color: #606060;
			}

			.main,
			.main>div {
				width: 100%;
				overflow: hidden;
			}

			.main>div {
				background-color: white;
				margin-bottom: 10px;
				box-sizing: border-box;
			}

			.main>.order {
				width: 100%;
				overflow: hidden;
				background: linear-gradient(to right, #3db4cc, #6fd6ea)!important;
				padding: 1.5rem 0;
				color: #f8e6db;
				color: white;
				font-weight: 600;
			}

			.order p {
				width: 100%;
				text-align: center;
				font-size: 17px;
				line-height: 25px;
			}

			.order p:nth-child(2) {
				font-size: 15px;
			}

			.top {
				position: relative;
				padding: 10px 30px 10px 40px;
			}

			.top p {
				display: flex;
			}

			.top p .fa {
				position: absolute;
				left: 12px;
				top: 13px;
				font-size: 25px;
				margin: 0;
				color: #6fd6ea !important;
			}

			.top p:nth-child(1) {
				font-size: 17px;
			}

			.top p:nth-child(1) span {
				color: #606060;
			}

			.top p:nth-child(2) {
				line-height: 20px;
				font-size: 13px;
				width: 100%;
				color: gray;
				word-break: break-all;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}

			.top p span {
				margin-bottom: 5px;
				line-height: 25px;
			}
			/*center*/

			.center .fl {
				padding: 0.5rem;
				box-sizing: border-box;
			}

			.center h3 {
				margin: 0;
				padding: 0;
				font-size: 16px;
				font-weight: 400;
				line-height: 25px;
				display: flex;
				padding: 10px 0;
				color: #606060 !important;
			}

			.center h3 .fa {
				color: #6fd6ea !important;
				line-height: 25px;
				margin: 0 12px;
				width: 16px;
			}

			.center .fl,
			.center .fr,
			.center .fl>div {
				width: 100%;
			}

			.center .fl>div {
				overflow: hidden;
				border-top: 1px solid #F0F0F3;
				font-size: 14px;
				padding: 10px 0;
			}

			.center .fl>div img,
			.center .fl>div .div {
				float: left;
			}

			.center .fl>div img {
				width: 60px;
				height: 60px;
				border: 1px solid #F3F3F3;
			}

			.center .fl>div .div {
				margin-top: 5px;
				box-sizing: border-box;
				padding-left: 10px;
				color: #606060 !important;
			}

			.center .fl>div .div p {
				line-height: 20px;
				width: 100%;
			}

			.center .fl>div .div p:nth-child(1) {
				width: 70%;
				font-size: 0.9rem !important;
				flex-wrap: 400 !important;
				word-break: break-all;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}

			.center .fl>div .div p:nth-child(2) {
				overflow: hidden;
				font-size: 14px;
			}

			.center .fl>div .div p:nth-child(2) span:nth-child(1) {
				float: left;
				display: flex;
				line-height: 20px;
			}

			.center .fl>div .div p:nth-child(2) span:nth-child(2) {
				float: right;
			}

			.center .fr {
				display: flex;
				justify-content: center;
				color: darkgrey;
				overflow: hidden;
				height: 0px;
				padding: 0.5rem 0;
			}

			.center .fr span {
				line-height: 30px;
				font-size: 15px;
				margin-right: 0.5rem;
				display: flex;
			}

			.center .fr span:nth-child(2) {
				font-size: 1.5rem;
			}
			/*bottom*/

			.bottom {
				position: fixed;
				bottom: 0;
				right: 0;
				border-top: 1px solid #F3F3F3;
				display: flex;
				justify-content: flex-end;
				padding: 10px;
				margin: 0 !important;
				background-color: white;
			}

			.bottom .button {
				width: 90px;
				height: 30px;
				text-align: center;
				line-height: 30px;
				margin-left: 0.5rem;
				background: linear-gradient(to right, #3db4cc, #6fd6ea)!important;
				color: white;
				box-sizing: border-box;
				border-radius: 15px;
				font-size: 15px;
			}

			.bottom p:nth-child(3) {
				color: #D37B57;
				border-color: #D37B57;
			}

			.he {
				background-color: #FF702A;
				color: white !important;
			}

			.center_1 {
				width: 100%;
				box-sizing: border-box;
				padding: 0.5rem;
				font-size: 14px;
			}

			.center_1 div,
			.center_1 p {
				display: flex;
			}

			.center_1 div {
				justify-content: space-between;
			}

			.center_1 p span {
				color: darkgray;
			}

			.center_1 div span:nth-child(1) {
				color: gray;
			}

			.center_1 p span {
				margin-right: 1rem;
				font-size: 12px;
			}

			.center_1 span {
				line-height: 20px;
			}

			.blue {
				color: #6fd6ea !important;
				/*font-weight: 600;*/
				/*font-size: 16px;*/
			}
			/*提示*/

			.modal1 {
				width: 80vw;
				position: fixed;
				z-index: 1002;
				left: 50%;
				margin-left: -40vw;
				border-radius: 0.5rem;
				top: 50%;
				margin-top: -60px;
				text-align: center;
				background: #e8e8e8;
				color: #3d4145;
				display: none;
				overflow: hidden;
			}

			.modal1 h5 {
				width: 100%;
				text-align: center;
				margin: 0;
				padding: 0;
				line-height: 40px;
				height: 30px;
				font-size: 16px;
				display: none;
			}

			.modal1 p {
				font-size: 16px;
			}

			.modal1 .modal1_p1 {
				box-sizing: border-box;
				padding: 15px 0;
			}

			.modal1 .modal1_p {
				line-height: 40px;
				display: flex;
				border-top: 1px solid white;
			}

			.modal1 .modal1_p span {
				width: 50%;
				text-align: center;
				padding: 0 .25rem;
				height: 40px;
				line-height: 40px;
				text-align: center;
				color: #6fd6ea;
				font-weight: 600;
				background: #e8e8e8;
				box-sizing: border-box;
			}

			.modal1 .modal1_p span:nth-child(1) {
				border-right: 1px solid white;
			}

			#goodcover {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				width: 100vw;
				height: 100vh;
				background-color: black;
				z-index: 1001;
				-moz-opacity: 0.65;
				opacity: 0.65;
			}

			.modal2 {
				width: 80%;
				background-color: white;
				border-radius: 10px;
				position: fixed;
				top: 50%;
				left: 50%;
				margin-left: -40%;
				margin-top: -130px;
				padding: 20px;
				box-sizing: border-box;
				display: none;
				z-index: 1002;
			}

			.modal2 p {
				display: flex;
				line-height: 40px;
			}

			.modal2 p span:nth-child(1) {
				width: 18px;
				height: 18px;
				border-radius: 50%;
				border: 1px solid #606060;
				margin-right: 10px;
				box-sizing: border-box;
				margin-top: 11px;
			}

			.modal2 .click span:nth-child(1) {
				border: 5px solid #3db4cc;
			}
			.modal2 h5{
				width: 100%;
				margin: 0px ;
			}
			.modal2 button{
				width: 50%;
				height: 30px;
				line-height: 30px;
				border-radius:10px ;
				margin-left: 25%;
				background-color: #3db4cc;
				color: white;
			}

		</style>
	</head>

	<body>
		<div class="wrapper" id="shopping_mall" style="padding-bottom: 47px;">
			<div class="header">
				<div class="">
					<span class="icon"></span><span>返回</span>
				</div>
				<h3>订单详情</h3>
			</div>
			<div class="main">
					{if condition="$oupermarketorder.status eq 4"}
						<div class="order">
							<p>交易关闭</p>
							<p>订单金额：￥{$oupermarketorder.order_price}</p>
						</div>
					{/if}
				<div class="top">
					<p><span class="fa fa-thumb-tack fa-2x"></span><span>{$ress.name}</span><span>{$ress.mobile}</span></p>
					<p>{$ress.address}</p>
				</div>
				<div class="center">
					<h3><span class="fa fa-institution"></span><span>趣味农场（{$adminuser.realname}）</span></h3>
					{for start="0" end="$oupermarketorder['arr_n']" name="k"}
					<div class="fl">
						<div class="">
							<img src="{$oupermarketorder.sp_img[$k]}" />
							<div class="div">
								<p style="font-size: 14px;">{$oupermarketorder.sp_name[$k]}</p>
								<p><span><span style="font-size: 15px; line-height: 18px;">x</span>{$oupermarketorder.quantity[$k]}</span><span>￥{$oupermarketorder.price[$k]}</span></p>
							</div>
						</div>
					</div>
					{/for}

					<div class="fr">
						<!--<span>还有<i></i>件</span>-->
						<span>显示全部</span>
						<span class="fa fa-angle-down"></span>
					</div>
				</div>
				<div class="center_1">
					<div class="">
						<span>商品小计</span><span>￥{$oupermarketorder.order_price}</span>
					</div>
					<div class="">
						<span>运费</span><span>￥0.00</span>
					</div>
					<div class="">
						<span>实付费（含运费）</span><span class="blue">￥{$oupermarketorder.order_price}</span>
					</div>
				</div>
				<div class="center_1">
					<p><span>订单编号</span><span>{$oupermarketorder.number}</span></p>
					<p><span>创建时间</span><span>{$oupermarketorder.create_time|date="Y-m-d H:i:s",###}</span></p>
				</div>
				<div class="bottom">
					<a href="tel:{$adminuser.mobile}"><p class="button">联系客服</p></a>

					{if condition="$oupermarketorder.status eq 1"}
					<p class="button">取消订单</p>
					{/if}

					{if condition="$oupermarketorder.status eq 2"}
					<p class="button" id="shou">确认收货</p>
					{/if}
					<!--<p class="button">支付订单</p>-->

				</div>
			</div>
		</div>
		<div class="background"></div>
		<p class="overtop"></p>
		<div class="modal1" id="moadel1">
			<h5>提示</h5>
			<p class="modal1_p1"></p>
			<p class="modal1_p"><span class="modal-button">取消</span><span class="modal-button modal-button-bold">确定</span></p>
		</div>
		<div class="modal1" id="moadel2">
			<h5>提示</h5>
			<p class="modal1_p1">确认收货</p>
			<p class="modal1_p"><span class="modal-button">取消</span><span class="modal-button modal-button-bold">确定</span></p>
		</div>
		<div class="modal2">
			<p><span></span><span>不取消了</span></p>
			<p><span></span><span>我不买了</span></p>
			<p><span></span><span>信息填写错误，重新拍</span></p>
			<p><span></span><span>同城见面交易</span></p>
			<p><span></span><span>其他原因</span></p>
			<h5><button >确认</button></h5>

		</div>
		<div id="goodcover"></div>
		<script src="__WAP__/js/header.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			sa();
			var id = {$oupermarketorder.id};

			function sa() {
				/*判断是否为苹果手机*/
				var u = navigator.userAgent;

				var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
				if(isiOS) {

				}
			}

			function len() {
				var lens = $(".center .fl").length;
				/*var lens = $(".center .fl>div").length - 2;*/
				/*$(".center .fr span i").text(lens);*/
				if(lens > 1) {
					$(".center .fr").css("height", "auto");
					/*$(".center .fl>div").css("display", "none");
					$(".center .fl>div:nth-child(1)").css("display", "block");
					*/
					for(var is = 2; is < 3; is++) {
						$(".center .fl:nth-child(" + is + ")>div").css("display", "none");

					}
					
				}
			}

			$(".fl>div .div").width(($(".center .fl>div").width() - 75) + "px");
			len();
			$(".center .fr").click(function() {
				if($(this).height() > 10) {
					$(".center .fl div").css("display", "block");
					$(this).css("display", "none");
				}
			})
			var nas;
			$(".bottom .button").click(function() {
				if($(this).text() == "取消订单") {
					nas = $(this).parent().parent();
					/*$(".modal1 h5 ").css("display", "block");
					$(".modal1 .modal1_p1").text("是否删除本条记录？")
					blocks();*/
					$("#goodcover").css("display", "block");
					$(".modal2").css("display", "block");
				} else if($(this).text() == "支付订单") {
					window.location.href = "{:url('Supermarket/pay')}";
				}
			})
			var t1 = 0;
			$(".modal2 p").click(function() {
				$(".modal2 p").removeClass("click");
				$(this).addClass("click");
				 t1 = $(".modal2 p").index($(this));


			})
			$(".modal2 h5 button").click(function(){
				/*判断是否取消，之后执行*/

					if(t1 == 0) {
						nones();
					} else {
						nones();

							$("#moadel1 h5 ").css("display", "block");
							$("#moadel1 .modal1_p1").text("是否取消订单？");
							$("#moadel1").css("display", "block");
							blocks();


					}

			})
			$("#shou").click(function(){

							$("#moadel2 h5 ").css("display", "block");
							$("#moadel2 .modal1_p1").text("确认收货？");
							$("#moadel2").css("display", "block");
							blocks();

				// $.ajax({
				//     type : 'POST',
				//     url : "{:url('supermarket/quedingdan')}",
				//     data : {id:id},
				//     success : function(data){
				// 		window.location.href = "{:url('Supermarket/dingdan')}";
				//     }
				// })

			})
			/*弹窗确定的删除*/
			$("#moadel1 .modal1_p .modal-button-bold").click(function() {
				nones();
				nas.remove();

				remark = $(".click").text();

				$.ajax({
				    type : 'POST',
				    url : "{:url('supermarket/dededingdan')}",
				    data : {id:id,remark:remark},
				    success : function(data){
						window.location.href = "{:url('Supermarket/dingdan')}";
				    }
				})

			});

			/*弹窗*/
			$("#goodcover").click(function() {
				nones();
			})
			$(".modal1_p span:nth-child(1)").click(function() {
				nones();
			})

			function blocks() {
				$("#goodcover").css("display", "block");
			}

			function nones() {
				$(".modal1").css("display", "none");
				$("#goodcover").css("display", "none");
				$(".modal2").css("display", "none");
			}


			/*确认收货*/
			$("#moadel2 .modal1_p .modal-button-bold").click(function(){
				nones();
				$.ajax({
				    type : 'POST',
				    url : "{:url('supermarket/quedingdan')}",
				    data : {id:id},
				    success : function(data){
						window.location.href = "{:url('Supermarket/dingdan')}";
				    }
				})
			})
		</script>
	</body>

</html>